import{_ as w,M as T,ai as _,N as r,O as G,P as i,Y as a,R as o,X as n,T as p,U as m,W as c,Z as b,$ as k,y as U,aj as z,al as E,am as C,aO as g,aP as Q,ak as f,an as V,S as $,ao as B,ap as M,aq as P}from"./index.6966c000.js";import{Q as q}from"./QBtnGroup.f34f8b9f.js";import{Q as A,C as I}from"./ClosePopup.0365c423.js";import{Q as R}from"./QTime.7cda4d52.js";import{a as x,Q as Y}from"./QItem.5053ba92.js";import{Q as N}from"./QPage.1d34d6a5.js";import{d as y}from"./date.aa6595d5.js";import{u as O}from"./store_goals.6513b014.js";import{u as j}from"./store_successes.a8606422.js";import{u as D}from"./store_settings.56ef584b.js";import"./TouchPan.7e73dcfe.js";import"./selection.4900666b.js";const F=T({name:"IndexPage",data(){return{changeAlertTimeDialog:!1,coinsStorageKey:"coins",enableNotificationsBeta:!1,days:[{label:"Sunday",value:0},{label:"Monday",value:1},{label:"Tuesday",value:2},{label:"Wednesday",value:3},{label:"Thursday",value:4},{label:"Friday",value:5},{label:"Saturday",value:6}]}},beforeMount(){this.goalsStore=O(),this.goalsStore.initialize(),this.successesStore=j(),this.successesStore.initialize(),this.settingsStore=D(),this.settingsStore.initialize(),this.goalsStore.sortUnscheduledGoals(this.settingsStore.getGoalsSortStyle()),this.$emit("refresh-header")},computed:{..._(D,["useBigButtons","goalsSortStyle"]),buttonClass(){return this.useBigButtons?"bigBtn":""},sortStyle(){return this.goalsSortStyle},buttonText(){return`Sort: ${this.sortStyle}`}},methods:{saveUnscheduledGoals(){this.$q.notify("Goals saved!"),this.goalsStore.saveUnscheduledGoals()},viewGoals(){this.$router.push("goals")},completeGoal(e){if(e.goal.length<1){this.$q.notify("Enter a title first!");return}if(e.stepsEnabled){for(var t=!0,d=0;d<e.stepsSize;d++)e.steps[d].value||(t=!1);if(!t){this.$q.notify("Complete all steps first!");return}}this.$q.dialog({title:"Confirm",message:'Confirm completion of goal: "'+e.goal+'"',cancel:!0,persistent:!0}).onOk(()=>{var S=this.goalsStore.goalReward(e);this.$q.notify("Rewarded "+S+" coins for completion!"),this.settingsStore.coins=this.settingsStore.coins+S,this.settingsStore.totalCoins=this.settingsStore.totalCoins+S;var u=Object.assign({},e);u.alertTime=null,u.date=this.getDateWithTime(),u.dateTieBreaker=this.getTime(),u.type="goal",this.successesStore.addEntry(u),this.$q.notify('Goal complete! "'+u.goal+'"'),this.settingsStore.saveCoins(),this.goalsStore.removeUnscheduledGoal(e),this.$emit("refresh-header")})},toggleSteps(e){e.steps?(e.stepsEnabled=!e.stepsEnabled,e.stepsEnabled&&e.stepsSize==0&&this.addSteps(e)):(e.stepsEnabled=!0,e.steps=[],e.stepsSize=0,this.addSteps(e)),this.saveUnscheduledGoals()},toggleGoalsSortStyle(){this.settingsStore.toggleGoalsSortStyle(),this.goalsStore.sortUnscheduledGoals(this.settingsStore.getGoalsSortStyle())},findMatchingInput(){return new Promise(e=>{this.$nextTick(()=>{this.$nextTick(()=>{for(const t in this.$refs.stepDescRef){const d=this.$refs.stepDescRef[t];if(d.modelValue==this.selectedStep.label){e(d);return}}e(null)})})})},handleStepInput(e){if(e.key){if(e.key=="Enter")e.preventDefault(),e.stopPropagation(),this.addSteps(this.selectedGoal,this.selectedStepIndex+1),this.findMatchingInput().then(t=>{t&&(this.selectedStep.label="",t.focus(),this.saveUnscheduledGoals())}),this.saveUnscheduledGoals();else if(e.key=="End")e.preventDefault(),e.stopPropagation(),this.$q.dialog({title:"Confirm",message:"Confirm deletion of step.",cancel:!0,persistent:!0}).onOk(()=>{this.selectedGoal.steps.splice(this.selectedStepIndex,1),this.selectedGoal.stepsSize--,this.selectedGoal.stepsSize==0&&(this.selectedGoal.stepsEnabled=!1,this.selectedStep=null),this.saveUnscheduledGoals()});else if(e.key=="Backspace"&&this.selectedStep.label==""){if(e.preventDefault(),e.stopPropagation(),this.selectedGoal.stepsSize==0){this.selectedGoal.stepsEnabled=!1,this.selectedStep=null;return}this.selectedStepIndex+1<this.selectedGoal.steps.length&&(this.selectedStep=this.selectedGoal.steps[this.selectedStepIndex+1]),this.selectedGoal.steps.splice(this.selectedStepIndex,1),this.selectedGoal.stepsSize--,this.selectedStep=this.selectedGoal.steps[this.selectedStepIndex],this.selectedGoal.stepsSize==0&&(this.selectedGoal.stepsEnabled=!1,this.selectedStep=null),this.saveUnscheduledGoals()}}},addSteps(e,t){e.stepsSize<20&&(e.stepsSize++,t?(e.steps.splice(t,0,{label:"",value:!1}),this.selectedStep=e.steps[t],this.selectedStep.label="   "):(e.steps.push({label:"",value:!1}),this.selectedStep=e.steps[e.stepsSize-1]),this.saveUnscheduledGoals())},removeSteps(e){e.steps.splice(e.stepsSize-1,1),e.stepsSize--,e.stepsSize==0&&(e.stepsEnabled=!1,this.selectedStep=null),this.saveUnscheduledGoals()},removeUnscheduledGoal(e){var t='Are you sure you want to delete the goal: "'+e.goal+'"?';e.goal.length<1&&(t="Are you sure you want to delete the unnamed goal?"),this.$q.dialog({title:"Confirm",message:t,cancel:!0,persistent:!0}).onOk(()=>{this.$q.notify('Goal deleted: "'+e.goal+'"'),this.goalsStore.removeUnscheduledGoal(e)})},getDate(){const e=Date().toString();return y.formatDate(e,"MMM D, YYYY")},getDateWithTime(){const e=Date().toString();return y.formatDate(e,"MMM D, YYYY, hh:mm A")},getTime(){return new Date().getTime()},displayAlertTime(e){const t=new Date;return t.setHours(parseInt(e.split(":")[0],10)),t.setMinutes(parseInt(e.split(":")[1],10)),t.toLocaleTimeString([],{hour:"numeric",minute:"2-digit",hour12:!0})},openDatePicker(e){e.changeDateDialog=!0},closeDatePicker(e){e.date=y.formatDate(e.date,"MMM D, YYYY"),e.changeDateDialog=!1,this.$q.notify("Goal added to schedule!"),this.goalsStore.addGoal(e),this.goalsStore.removeUnscheduledGoal(e),this.goalsStore.sortGoals(this.settingsStore.getGoalsSortStyle()),this.goalsStore.sortUnscheduledGoals(this.settingsStore.getGoalsSortStyle())},cancelDatePicker(e){e.changeDateDialog=!1,this.goalsStore.saveUnscheduledGoals()}}}),W={class:"q-gutter-md row justify-center"},H={class:"goal-data"},K={class:"text-h6"},L={class:"difficulty-select"},X={key:0},Z=a("br",null,null,-1),J={class:"steps_checkboxes full-width"},ee={class:"stepTable full-width"},te={scope:"row",class:"firstColumn"},se=a("br",null,null,-1),le={key:1},oe={"q-pa-lg":"",class:"text-black"},ae={class:"row items-center justify-end"},ie=a("span",{style:{"margin-left":"0.5em"}},"Schedule Goal",-1),ne={key:2,class:"alert-data"},re={key:0,"q-pa-lg":"",class:"text-black"},de=a("br",null,null,-1),ue={class:"row items-center justify-center"};function ce(e,t,d,S,u,he){return r(),G(N,{"items-center":"",class:"goal-page"},{default:i(()=>[a("div",W,[o(q,{"no-wrap":""},{default:i(()=>[o(n,{size:"lg",class:"top-button",onClick:t[0]||(t[0]=s=>this.goalsStore.addUnscheduledGoal(null,this.settingsStore.getGoalsSortStyle())),style:{"margin-left":"0.5rem"}},{default:i(()=>[p("Add New Goal")]),_:1}),o(n,{size:"lg",class:"top-button",onClick:t[1]||(t[1]=s=>this.toggleGoalsSortStyle()),style:{"margin-left":"1rem","margin-right":"0.5rem"}},{default:i(()=>[p(m(e.buttonText),1)]),_:1}),o(n,{size:"lg",class:"top-button",onClick:t[2]||(t[2]=s=>this.viewGoals()),style:{"margin-left":"0.5rem","margin-right":"0.5rem"}},{default:i(()=>[p("Back to Schedule")]),_:1})]),_:1})]),o(x,null,{default:i(()=>[(r(!0),c(k,null,b(this.goalsStore.unscheduledGoals,s=>U((r(),G(Y,{key:s},{default:i(()=>[o(z,{class:"goal-card text-white full-width"},{default:i(()=>[o(E,null,{default:i(()=>[a("div",H,[a("div",K,[o(C,{multiline:"",autogrow:"",wrap:"on","min-rows":1,"max-rows":10,standout:"bg-primary text-black",class:"full-width text-h6","input-class":"text-left",label:"Goal Title",modelValue:s.goal,"onUpdate:modelValue":[l=>s.goal=l,t[3]||(t[3]=l=>this.goalsStore.saveUnscheduledGoals())],onFocus:t[4]||(t[4]=l=>this.$q.notify("Goal will be saved once you enter a title"))},null,8,["modelValue","onUpdate:modelValue"])]),a("div",L,[o(g,{"keep-color":"",modelValue:s.difficulty,"onUpdate:modelValue":[l=>s.difficulty=l,t[5]||(t[5]=l=>this.goalsStore.sortUnscheduledGoals(this.settingsStore.getGoalsSortStyle()))],val:"Easy",label:"Easy",color:"green"},null,8,["modelValue","onUpdate:modelValue"]),o(g,{"keep-color":"",modelValue:s.difficulty,"onUpdate:modelValue":[l=>s.difficulty=l,t[6]||(t[6]=l=>this.goalsStore.sortUnscheduledGoals(this.settingsStore.getGoalsSortStyle()))],val:"Moderate",label:"Moderate",color:"orange"},null,8,["modelValue","onUpdate:modelValue"]),o(g,{"keep-color":"",modelValue:s.difficulty,"onUpdate:modelValue":[l=>s.difficulty=l,t[7]||(t[7]=l=>this.goalsStore.sortUnscheduledGoals(this.settingsStore.getGoalsSortStyle()))],val:"Hard",label:"Hard",color:"red"},null,8,["modelValue","onUpdate:modelValue"]),o(g,{"keep-color":"",modelValue:s.difficulty,"onUpdate:modelValue":[l=>s.difficulty=l,t[8]||(t[8]=l=>this.goalsStore.sortUnscheduledGoals(this.settingsStore.getGoalsSortStyle()))],val:"Epic",label:"Epic",color:"black"},null,8,["modelValue","onUpdate:modelValue"])]),s.stepsEnabled?(r(),c("div",X,[a("p",null,[p(" Base Reward: "+m(this.goalsStore.baseReward(s))+" coins.",1),Z]),a("div",J,[a("table",ee,[a("thead",null,[(r(!0),c(k,null,b(s.steps,(l,v)=>(r(),c("tr",{key:v},[a("th",te,[o(Q,{modelValue:l.value,"onUpdate:modelValue":[h=>l.value=h,t[9]||(t[9]=h=>this.saveUnscheduledGoals())]},null,8,["modelValue","onUpdate:modelValue"])]),a("th",null,[o(C,{ref_for:!0,ref:"stepDescRef",multiline:"",autogrow:"",wrap:"on","min-rows":1,"max-rows":10,standout:"bg-primary text-black",class:"full-width","input-class":"text-left",label:"Step Description",modelValue:l.label,"onUpdate:modelValue":[h=>l.label=h,t[10]||(t[10]=h=>this.goalsStore.saveUnscheduledGoals())],onKeydown:e.handleStepInput,onFocus:h=>{this.selectedGoal=s,this.selectedStep=l,this.selectedStepIndex=v}},null,8,["modelValue","onUpdate:modelValue","onKeydown","onFocus"])])]))),128))])]),o(n,{flat:"",dense:"",glossy:"",icon:"add",color:"green",onClick:l=>e.addSteps(s)},null,8,["onClick"]),o(n,{flat:"",dense:"",glossy:"",icon:"remove",color:"red",onClick:l=>e.removeSteps(s)},null,8,["onClick"])]),p(" Total Reward: "+m(this.goalsStore.goalReward(s))+" coins.",1),se])):(r(),c("div",le,[a("p",oe," Reward for completion: "+m(this.goalsStore.goalReward(s))+" coins. ",1)])),a("div",{class:f(["text-goal",{overdue:this.goalsStore.goalExpired(s)}])},[o(n,{flat:"",glossy:"",color:"green",icon:"event",class:f(e.buttonClass),onClick:l=>e.openDatePicker(s)},{default:i(()=>[o(V,{modelValue:s.changeDateDialog,"onUpdate:modelValue":l=>s.changeDateDialog=l},{default:i(()=>[o(A,{modelValue:s.date,"onUpdate:modelValue":[l=>s.date=l,l=>e.closeDatePicker(s)]},{default:i(()=>[a("div",ae,[U(o(n,{onClick:l=>e.cancelDatePicker(s),label:"Cancel",color:"primary",flat:""},null,8,["onClick"]),[[I]])])]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["modelValue","onUpdate:modelValue"]),ie]),_:2},1032,["class","onClick"])],2),this.settingsStore.useNotificationBeta?(r(),c("div",ne,[s.alertTime?(r(),c("p",re,[de,p("Alert Time: "+m(e.displayAlertTime(s.alertTime))+" day of goal. ",1)])):$("",!0),o(V,{modelValue:s.changeAlertTimeDialog,"onUpdate:modelValue":l=>s.changeAlertTimeDialog=l},{default:i(()=>[o(R,{modelValue:s.alertTime,"onUpdate:modelValue":[l=>s.alertTime=l,t[11]||(t[11]=l=>this.saveUnscheduledGoals())],onClose:l=>e.closeAlertTimeDialog(s)},{default:i(()=>[a("div",ue,[o(n,{"float-left":"",label:"Disable",onClick:l=>this.goalsStore.disableNotification(s),color:"primary",flat:""},null,8,["onClick"]),o(n,{label:"Close",color:"primary",onClick:l=>e.closeAlertTimeDialog(s),flat:""},null,8,["onClick"])])]),_:2},1032,["modelValue","onUpdate:modelValue","onClose"])]),_:2},1032,["modelValue","onUpdate:modelValue"])])):$("",!0)])]),_:2},1024),o(B,{dark:""}),o(M,null,{default:i(()=>[o(n,{class:f(e.buttonClass),flat:"",glossy:"",icon:"check",color:"green",onClick:l=>e.completeGoal(s)},null,8,["class","onClick"]),o(n,{class:f(e.buttonClass),flat:"",glossy:"",icon:"123",color:"yellow",onClick:l=>e.toggleSteps(s),style:{"margin-left":"0"}},null,8,["class","onClick"]),o(n,{class:f(e.buttonClass),flat:"",glossy:"",icon:"delete",color:"black",onClick:l=>this.removeUnscheduledGoal(s),style:{"margin-left":"0"}},null,8,["class","onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)),[[P]])),128))]),_:1})]),_:1})}var Ve=w(F,[["render",ce]]);export{Ve as default};
