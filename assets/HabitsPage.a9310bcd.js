import{_,M as b,d as D,ai as w,N as l,O as k,P as n,Y as a,R as i,X as d,aj as c,T as m,W as r,S as p,Z as $,$ as H,y as V,ak as A,al as Q,am as S,U as h,an as C,ao as R,ap as q,aq as B}from"./index.0063c7d2.js";import{Q as N}from"./QBtnGroup.8e783e17.js";import{Q as v}from"./QTime.89d4ddcb.js";import{a as U,Q as M}from"./QItem.b9af6ae6.js";import{Q as Y}from"./QPage.e128a380.js";import{d as y}from"./date.8adeaf97.js";import{u as L,Q as j}from"./QSpinnerFacebook.a4466318.js";import{u as P}from"./store_habits.386a302d.js";import{u as z}from"./store_successes.d7807ae3.js";import{u as T}from"./store_settings.854f0a41.js";import"./TouchPan.de3812d2.js";import"./selection.dec81627.js";const I=b({name:"HabitsPage",setup(){const e=L();let s;return D(()=>{s!==void 0&&(clearTimeout(s),e.loading.hide())}),{showLoading(){e.loading.show({spinner:j,spinnerColor:"white",spinnerSize:140,backgroundColor:"black",message:"Loading your habits... Please wait!",messageColor:"white"}),s=setTimeout(()=>{e.loading.hide(),s=void 0},500)}}},data(){return{changeDateDialog:!1,changeAlertTimeDialog:!1}},beforeMount(){this.habitsStore=P(),this.habitsStore.initialize(),this.successesStore=z(),this.successesStore.initialize(),this.settingsStore=T(),this.settingsStore.initialize(),this.$emit("refresh-header"),this.habitsStore.habits.forEach(e=>{e.startDate==null&&e.lastDate!=null&&(e.startDate=e.date)})},created(){this.showLoading()},computed:{...w(T,["useBigButtons"]),buttonClass(){return this.useBigButtons?"bigBtn":""},habitCardClass(e){return s=>this.habitsStore.habitNotCompleted(s)?"habit-card":"habit-card-complete"}},methods:{completeHabit(e){if(this.habitsStore.habitNotCompleted(e)&&!e.ready){e.ready=!0,this.$q.notify("Click again to mark complete!");return}var s=this.getDateWithTime();this.habitsStore.habitNotCompleted(e)?e.habit.length===0?this.$q.notify("Please enter a title for your new habit!"):this.$q.dialog({title:"Confirm",message:'Confirm completion of habit: "'+e.habit+'"',cancel:!0,persistent:!0}).onOk(()=>{e.lastDate==null&&(e.startDate=s),this.habitsStore.streakExpired(e)&&(e.streak=0),e.lastDate=s,e.dateTieBreaker=this.getTime(),e.streak=e.streak+1;var g=this.habitsStore.habitReward(e.streak);this.$q.notify("Rewarded "+g+" coins for completion!"),this.settingsStore.coins=this.settingsStore.coins+g,this.settingsStore.totalCoins=this.settingsStore.totalCoins+g,e.total=e.total+1,e.streak>e.longestStreak&&(e.longestStreak=e.streak),this.$q.notify(e.habit+" completed for "+this.getDate()+"!");var u=!1;if((e.streak==3||e.streak==5||e.streak==7||e.streak==14||e.streak==30||e.streak==60)&&(u=!0),u){var f=Object.assign({},e);f.date=this.getDateWithTime(),f.type="habit",this.successesStore.addEntry(f),this.$q.notify("Reached milestone of "+f.streak+" days!")}this.settingsStore.saveCoins(),this.$emit("refresh-header"),this.habitsStore.sortHabits()}):this.$q.notify("Habit already complete until "+e.resetTime+"!")},removeHabit(e){e.habit?this.$q.dialog({title:"Confirm",message:'Are you sure you want to delete the habit: "'+e.habit+'"?',cancel:!0,persistent:!0}).onOk(()=>{this.habitsStore.removeHabit(e),this.$q.notify('Habit deleted: "'+e.habit+'"')}):this.habitsStore.removeHabit(e)},hideTutorial(){this.$q.dialog({title:"Acknowledge",message:"Have you read and understood the instructions?",cancel:!0,persistent:!0}).onOk(()=>{this.settingsStore.tutorialSettings.habitsTutorialHidden=!0,this.settingsStore.saveTutorialSettings()})},getDate(){const e=Date().toString();return y.formatDate(e,"MMM D, YYYY")},getDateWithTime(){const e=Date().toString();return y.formatDate(e,"MMM D, YYYY, hh:mm A")},getTime(){return new Date().getTime()},displayAlertTime(e){const s=new Date;return s.setHours(parseInt(e.split(":")[0],10)),s.setMinutes(parseInt(e.split(":")[1],10)),s.toLocaleTimeString([],{hour:"numeric",minute:"2-digit",hour12:!0})},closeAlertTimeDialog(e){e.changeAlertTimeDialog=!1,this.habitsStore.saveHabits()},showResetTime(e){return e.resetTime?e.resetTime:"12:00 AM"},closeResetTimeDialog(e){e.changeResetTimeDialog=!1,this.habitsStore.saveHabits()}}}),O={class:"flex justify-center q-mb-lg"},E={key:0,class:"tutorial"},W=a("p",null,' Click "New Habit" to create a new Habit. You can click the Habit Reset Time (which defaults to 12:00 AM) to adjust it. This is the time the habit resets and can be completed again. If an entire cycle goes without completion, then the habit will lose its streak and have to be restarted. Larger streaks grant higher coin rewards, so stay consistent for maximum benefits! ',-1),x={class:"habit-data"},F={class:"text-h6"},G={key:0},X={key:1},Z={class:"reset-data"},J=["onClick"],K={class:"row items-center justify-center"},ee=a("br",null,null,-1),te={key:0},se=a("span",{class:"bold"},"Current Streak:",-1),oe=a("span",{class:"bold"},"Longest Streak:",-1),ae=a("span",{class:"bold"},"Total completions:",-1),ie=a("br",null,null,-1),le=a("span",{class:"bold"},"Started:",-1),ne=a("span",{class:"bold"},"Last completed:",-1),re=a("br",null,null,-1),de=a("span",{class:"bold"},"Reward for next completion:",-1),ue={key:1,class:"alert-data"},ce={key:0,"q-pa-lg":"",class:"text-black"},me=a("br",null,null,-1),he={class:"row items-center justify-center"},ge={key:0},fe={key:0},pe={key:1},ke={key:1},Se={key:2,class:"alert-data"};function Ce(e,s,g,u,f,ve){return l(),k(Y,{"items-center":"",class:"habits-page"},{default:n(()=>[a("div",O,[i(N,null,{default:n(()=>[i(d,{class:c([e.buttonClass,"top-button"]),onClick:s[0]||(s[0]=t=>this.habitsStore.addHabit())},{default:n(()=>[m("New Habit")]),_:1},8,["class"])]),_:1})]),this.settingsStore.tutorialSettings.habitsTutorialHidden?p("",!0):(l(),r("div",E,[W,i(d,{flat:"",dense:"",glossy:"",icon:"done",color:"check",onClick:s[1]||(s[1]=t=>this.hideTutorial())})])),i(U,null,{default:n(()=>[(l(!0),r(H,null,$(this.habitsStore.habits,t=>V((l(),k(M,{key:t},{default:n(()=>[i(A,{class:c([e.habitCardClass(t),"text-white full-width"])},{default:n(()=>[i(Q,null,{default:n(()=>[a("div",x,[a("div",F,[t.lastDate!=null?(l(),r("div",G,[i(S,{multiline:"",autogrow:"",wrap:"on","min-rows":1,"max-rows":10,standout:"bg-primary text-black",class:"full-width text-h6","input-class":"text-left",label:"Habit Title",modelValue:t.habit,"onUpdate:modelValue":o=>t.habit=o,readonly:""},null,8,["modelValue","onUpdate:modelValue"])])):(l(),r("div",X,[i(S,{multiline:"",autogrow:"",wrap:"on","min-rows":1,"max-rows":10,standout:"bg-primary text-black",class:"full-width text-h6","input-class":"text-left",label:"Habit Title",modelValue:t.habit,"onUpdate:modelValue":[o=>t.habit=o,s[2]||(s[2]=o=>this.habitsStore.saveHabits())],onFocus:s[3]||(s[3]=o=>this.$q.notify("Habit will be saved once you enter a title"))},null,8,["modelValue","onUpdate:modelValue"])])),a("div",Z,[a("p",{class:c({dashed:!t.lastDate}),onClick:o=>{t.lastDate||(t.changeResetTimeDialog=!0)}}," Habit Resets at "+h(e.showResetTime(t)),11,J),i(C,{modelValue:t.changeResetTimeDialog,"onUpdate:modelValue":o=>t.changeResetTimeDialog=o},{default:n(()=>[i(v,{mask:"hh:mm A",modelValue:t.resetTime,"onUpdate:modelValue":[o=>t.resetTime=o,s[4]||(s[4]=o=>this.habitsStore.saveHabits())],onClose:o=>e.closeResetTimeDialog(t)},{default:n(()=>[a("div",K,[i(d,{label:"Close",color:"primary",onClick:o=>e.closeResetTimeDialog(t),flat:""},null,8,["onClick"])])]),_:2},1032,["modelValue","onUpdate:modelValue","onClose"])]),_:2},1032,["modelValue","onUpdate:modelValue"])])]),ee,t.startDate!=null?(l(),r("div",te,[a("p",null,[se,m(" "+h(t.streak)+" days. ",1)]),a("p",null,[oe,m(" "+h(t.longestStreak)+" days. ",1)]),a("p",null,[ae,m(" "+h(t.total)+" completions. ",1)]),ie,a("p",null,[le,m(" "+h(t.startDate),1)]),a("p",null,[ne,m(" "+h(t.lastDate),1)]),re])):p("",!0),a("p",null,[de,m(" "+h(this.habitsStore.habitReward(t.streak+1))+" coins. ",1)]),this.settingsStore.useNotificationBeta?(l(),r("div",ue,[t.alertTime?(l(),r("p",ce,[me,m("Alert Time: "+h(e.displayAlertTime(t.alertTime))+" Daily ",1)])):p("",!0),i(C,{modelValue:t.changeAlertTimeDialog,"onUpdate:modelValue":o=>t.changeAlertTimeDialog=o},{default:n(()=>[i(v,{modelValue:t.alertTime,"onUpdate:modelValue":[o=>t.alertTime=o,s[5]||(s[5]=o=>this.habitsStore.saveHabits())],onClose:o=>e.closeAlertTimeDialog(t)},{default:n(()=>[a("div",he,[i(d,{"float-left":"",label:"Disable",onClick:o=>this.habitsStore.disableNotification(t),color:"primary",flat:""},null,8,["onClick"]),i(d,{label:"Close",color:"primary",onClick:o=>e.closeAlertTimeDialog(t),flat:""},null,8,["onClick"])])]),_:2},1032,["modelValue","onUpdate:modelValue","onClose"])]),_:2},1032,["modelValue","onUpdate:modelValue"])])):p("",!0)])]),_:2},1024),i(R,{dark:""}),i(q,null,{default:n(()=>[this.habitsStore.habitNotCompleted(t)?(l(),r("div",ge,[t.ready?(l(),r("div",fe,[i(d,{class:c(e.buttonClass),flat:"",dense:"",icon:"done_all",color:"green",glossy:"",onClick:o=>e.completeHabit(t)},null,8,["class","onClick"])])):(l(),r("div",pe,[i(d,{class:c(e.buttonClass),flat:"",dense:"",icon:"check",color:"green",glossy:"",onClick:o=>e.completeHabit(t)},null,8,["class","onClick"])]))])):(l(),r("div",ke,[i(d,{class:c(e.buttonClass),flat:"",dense:"",icon:"assignment_turned_in",color:"green",glossy:"",onClick:o=>e.completeHabit(t)},null,8,["class","onClick"])])),this.settingsStore.useNotificationBeta?(l(),r("div",Se,[i(d,{class:c(e.buttonClass),flat:"",dense:"",icon:"notifications",color:"red",glossy:"",onClick:o=>t.changeAlertTimeDialog=!0},null,8,["class","onClick"])])):p("",!0),i(d,{class:c(e.buttonClass),flat:"",dense:"",icon:"delete",color:"black",glossy:"",onClick:o=>e.removeHabit(t)},null,8,["class","onClick"])]),_:2},1024)]),_:2},1032,["class"])]),_:2},1024)),[[B]])),128))]),_:1})]),_:1})}var qe=_(I,[["render",Ce]]);export{qe as default};
