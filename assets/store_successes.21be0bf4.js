import{a4 as o}from"./index.445a0815.js";import{d as h}from"./QItem.dfa229b6.js";const r="store_successes",c="store_successes_next_id",a="store_successes_archive",n="store_successes_first_date";function d(){const e=Date().toString();return h.formatDate(e,"MMM D, YYYY")}const S=o("successes",{state:()=>({successes:[],nextId:0,successesArchive:[],firstSuccessDate:null}),actions:{initialize(){const e=localStorage.getItem(c);this.nextId=e?JSON.parse(e):0;const s=localStorage.getItem(n);s&&(this.firstSuccessDate=s);const t=localStorage.getItem(r);t?(this.successes=JSON.parse(t),this.successes.forEach(i=>{i.id||(i.id=this.getNextId())})):this.successes={},Array.isArray(this.successes)||(this.successes=[])},getNextId(){return this.nextId++,this.saveNextId(),this.nextId-1},saveNextId(){localStorage.setItem(c,JSON.stringify(this.nextId))},initializeArchive(){const e=localStorage.getItem(a);e?(this.successesArchive=JSON.parse(e),this.successesArchive.forEach(s=>{s.id||(s.id=this.getNextId())})):this.successesArchive={},Array.isArray(this.successesArchive)||(this.successesArchive=[])},addEntry(e){e.id=this.getNextId(),this.successes.push(e),this.firstSuccessDate||(this.firstSuccessDate=d(),this.saveFirstSuccessDate()),this.sortEntries()},removeEntry(e){const s=this.successes.findIndex(t=>t.id===e);this.successes.splice(s,1),this.saveEntries()},removeArchivedEntry(e){const s=this.successesArchive.findIndex(t=>t.id===e);this.successesArchive.splice(s,1),this.saveArchivedEntries()},saveEntries(){localStorage.setItem(r,JSON.stringify(this.successes))},saveArchivedEntries(){localStorage.setItem(a,JSON.stringify(this.successesArchive))},saveFirstSuccessDate(){localStorage.setItem(n,this.firstSuccessDate)},eraseSettings(){localStorage.setItem(n,"")},eraseEntries(){localStorage.setItem(r,JSON.stringify([])),localStorage.setItem(c,JSON.stringify(0))},eraseArchivedEntries(){localStorage.setItem(a,JSON.stringify([]))},sortEntries(){this.successes.sort((e,s)=>{const t=new Date(e.date),i=new Date(s.date);return t<i?1:t>i?-1:s.dateTieBreaker-e.dateTieBreaker}),this.saveEntries()},sortArchivedEntries(){this.successesArchive.sort((e,s)=>{const t=new Date(e.date),i=new Date(s.date);return t<i?1:t>i?-1:s.dateTieBreaker-e.dateTieBreaker}),this.saveArchivedEntries()},daysSinceFirstSuccess(){const e=this.firstSuccessDate?new Date(this.firstSuccessDate):new Date,s=new Date,t=Math.abs(s-e);let i=Math.round(t/(1e3*60*60*24));return i<1&&(i=1),i},archiveOldEntries(){if(this.successes.length<=30)return!0;for(;this.successes.length>30;)this.successesArchive.unshift(this.successes.pop());return this.saveEntries(),this.saveArchivedEntries(),!1}}});export{S as u};
