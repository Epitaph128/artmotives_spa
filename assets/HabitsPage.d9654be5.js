import{_ as D,M as T,d as b,ai as w,N as i,O as k,P as n,Y as a,R as l,X as d,aj as u,T as c,W as r,Z as $,$ as V,y as H,ak as Q,al as R,am as S,U as f,an as C,S as h,ao as A,ap as q,aq as B}from"./index.e83fb6c8.js";import{Q as U}from"./QBtnGroup.5c63f25a.js";import{Q as y}from"./QTime.adb94651.js";import{a as N,Q as M}from"./QItem.58c1d596.js";import{Q as Y}from"./QPage.1952db83.js";import{d as _}from"./date.73c2f1ba.js";import{u as L,Q as j}from"./QSpinnerFacebook.b6e4d841.js";import{u as P}from"./store_habits.ffb57927.js";import{u as z}from"./store_successes.1644c946.js";import{u as v}from"./store_settings.87ab6a6e.js";import"./TouchPan.a63f5a2f.js";import"./selection.0bfab6ad.js";const E=T({name:"HabitsPage",setup(){const e=L();let s;return b(()=>{s!==void 0&&(clearTimeout(s),e.loading.hide())}),{showLoading(){e.loading.show({spinner:j,spinnerColor:"white",spinnerSize:140,backgroundColor:"black",message:"Loading your habits... Please wait!",messageColor:"white"}),s=setTimeout(()=>{e.loading.hide(),s=void 0},500)}}},data(){return{changeDateDialog:!1,changeAlertTimeDialog:!1}},beforeMount(){this.habitsStore=P(),this.habitsStore.initialize(),this.successesStore=z(),this.successesStore.initialize(),this.settingsStore=v(),this.settingsStore.initialize(),this.$emit("refresh-header"),this.habitsStore.habits.forEach(e=>{e.startDate==null&&e.lastDate!=null&&(e.startDate=e.date)})},created(){this.showLoading()},computed:{...w(v,["useBigButtons"]),buttonClass(){return this.useBigButtons?"bigBtn":""},habitCardClass(e){return s=>this.habitsStore.habitNotCompleted(s)?"habit-card":"habit-card-complete"}},methods:{completeHabit(e){if(this.habitsStore.habitNotCompleted(e)&&!e.ready){e.ready=!0,this.$q.notify("Click again to mark complete!");return}var s=this.getDateWithTime();this.habitsStore.habitNotCompleted(e)?e.habit.length===0?this.$q.notify("Please enter a title for your new habit!"):this.$q.dialog({title:"Confirm",message:'Confirm completion of habit: "'+e.habit+'"',cancel:!0,persistent:!0}).onOk(()=>{e.lastDate==null&&(e.startDate=s),this.habitsStore.streakExpired(e)&&(e.streak=0),e.lastDate=s,e.dateTieBreaker=this.getTime(),e.streak=e.streak+1;var p=this.habitsStore.habitReward(e.streak);this.$q.notify("Rewarded "+p+" coins for completion!"),this.settingsStore.coins=this.settingsStore.coins+p,this.settingsStore.totalCoins=this.settingsStore.totalCoins+p,e.total=e.total+1,e.streak>e.longestStreak&&(e.longestStreak=e.streak),this.$q.notify(e.habit+" completed for "+this.getDate()+"!");var m=!1;if((e.streak==3||e.streak==5||e.streak==7||e.streak==14||e.streak==30||e.streak==60)&&(m=!0),m){var g=Object.assign({},e);g.date=this.getDateWithTime(),g.type="habit",this.successesStore.addEntry(g),this.$q.notify("Reached milestone of "+g.streak+" days!")}this.settingsStore.saveCoins(),this.$emit("refresh-header"),this.habitsStore.sortHabits()}):this.$q.notify("Habit already complete until "+e.resetTime+"!")},removeHabit(e){e.habit?this.$q.dialog({title:"Confirm",message:'Are you sure you want to delete the habit: "'+e.habit+'"?',cancel:!0,persistent:!0}).onOk(()=>{this.habitsStore.removeHabit(e),this.$q.notify('Habit deleted: "'+e.habit+'"')}):this.habitsStore.removeHabit(e)},getDate(){const e=Date().toString();return _.formatDate(e,"MMM D, YYYY")},getDateWithTime(){const e=Date().toString();return _.formatDate(e,"MMM D, YYYY, hh:mm A")},getTime(){return new Date().getTime()},displayAlertTime(e){const s=new Date;return s.setHours(parseInt(e.split(":")[0],10)),s.setMinutes(parseInt(e.split(":")[1],10)),s.toLocaleTimeString([],{hour:"numeric",minute:"2-digit",hour12:!0})},closeAlertTimeDialog(e){e.changeAlertTimeDialog=!1,this.habitsStore.saveHabits()},showResetTime(e){return e.resetTime?e.resetTime:"12:00 AM"},closeResetTimeDialog(e){e.changeResetTimeDialog=!1,this.habitsStore.saveHabits()}}}),I={class:"flex justify-center q-mb-lg"},O=a("div",{class:"flex justify-center q-mb-lg"},[a("h5",{dense:""}," Complete your habits every day for increasing rewards as your streak continues! ")],-1),W={class:"habit-data"},x={class:"text-h6"},F={key:0},G={key:1},X={class:"reset-data"},Z=["onClick"],J={class:"row items-center justify-center"},K=a("br",null,null,-1),ee={key:0},te=a("span",{class:"bold"},"Current Streak:",-1),se=a("span",{class:"bold"},"Longest Streak:",-1),oe=a("span",{class:"bold"},"Total completions:",-1),ae=a("br",null,null,-1),le=a("span",{class:"bold"},"Started:",-1),ie=a("span",{class:"bold"},"Last completed:",-1),ne=a("br",null,null,-1),re=a("span",{class:"bold"},"Reward for next completion:",-1),de={key:1,class:"alert-data"},me={key:0,"q-pa-lg":"",class:"text-black"},ue=a("br",null,null,-1),ce={class:"row items-center justify-center"},fe={key:0},pe={key:0},ge={key:1},he={key:1},ke={key:2,class:"alert-data"};function Se(e,s,p,m,g,Ce){return i(),k(Y,{"items-center":"",class:"habits-page"},{default:n(()=>[a("div",I,[l(U,null,{default:n(()=>[l(d,{class:u([e.buttonClass,"top-button"]),onClick:s[0]||(s[0]=t=>this.habitsStore.addHabit())},{default:n(()=>[c("New Habit")]),_:1},8,["class"])]),_:1})]),O,l(N,null,{default:n(()=>[(i(!0),r(V,null,$(this.habitsStore.habits,t=>H((i(),k(M,{key:t},{default:n(()=>[l(Q,{class:u([e.habitCardClass(t),"text-white full-width"])},{default:n(()=>[l(R,null,{default:n(()=>[a("div",W,[a("div",x,[t.lastDate!=null?(i(),r("div",F,[l(S,{multiline:"",autogrow:"",wrap:"on","min-rows":1,"max-rows":10,standout:"bg-primary text-black",class:"full-width text-h6","input-class":"text-left",label:"Habit Title",modelValue:t.habit,"onUpdate:modelValue":o=>t.habit=o,readonly:""},null,8,["modelValue","onUpdate:modelValue"])])):(i(),r("div",G,[l(S,{multiline:"",autogrow:"",wrap:"on","min-rows":1,"max-rows":10,standout:"bg-primary text-black",class:"full-width text-h6","input-class":"text-left",label:"Habit Title",modelValue:t.habit,"onUpdate:modelValue":[o=>t.habit=o,s[1]||(s[1]=o=>this.habitsStore.saveHabits())],onFocus:s[2]||(s[2]=o=>this.$q.notify("Habit will be saved once you enter a title"))},null,8,["modelValue","onUpdate:modelValue"])])),a("div",X,[a("p",{class:u({dashed:!t.lastDate}),onClick:o=>{t.lastDate||(t.changeResetTimeDialog=!0)}}," Habit Resets at "+f(e.showResetTime(t)),11,Z),l(C,{modelValue:t.changeResetTimeDialog,"onUpdate:modelValue":o=>t.changeResetTimeDialog=o},{default:n(()=>[l(y,{mask:"hh:mm A",modelValue:t.resetTime,"onUpdate:modelValue":[o=>t.resetTime=o,s[3]||(s[3]=o=>this.habitsStore.saveHabits())],onClose:o=>e.closeResetTimeDialog(t)},{default:n(()=>[a("div",J,[l(d,{label:"Close",color:"primary",onClick:o=>e.closeResetTimeDialog(t),flat:""},null,8,["onClick"])])]),_:2},1032,["modelValue","onUpdate:modelValue","onClose"])]),_:2},1032,["modelValue","onUpdate:modelValue"])])]),K,t.startDate!=null?(i(),r("div",ee,[a("p",null,[te,c(" "+f(t.streak)+" days. ",1)]),a("p",null,[se,c(" "+f(t.longestStreak)+" days. ",1)]),a("p",null,[oe,c(" "+f(t.total)+" completions. ",1)]),ae,a("p",null,[le,c(" "+f(t.startDate),1)]),a("p",null,[ie,c(" "+f(t.lastDate),1)]),ne])):h("",!0),a("p",null,[re,c(" "+f(this.habitsStore.habitReward(t.streak+1))+" coins. ",1)]),this.settingsStore.useNotificationBeta?(i(),r("div",de,[t.alertTime?(i(),r("p",me,[ue,c("Alert Time: "+f(e.displayAlertTime(t.alertTime))+" Daily ",1)])):h("",!0),l(C,{modelValue:t.changeAlertTimeDialog,"onUpdate:modelValue":o=>t.changeAlertTimeDialog=o},{default:n(()=>[l(y,{modelValue:t.alertTime,"onUpdate:modelValue":[o=>t.alertTime=o,s[4]||(s[4]=o=>this.habitsStore.saveHabits())],onClose:o=>e.closeAlertTimeDialog(t)},{default:n(()=>[a("div",ce,[l(d,{"float-left":"",label:"Disable",onClick:o=>this.habitsStore.disableNotification(t),color:"primary",flat:""},null,8,["onClick"]),l(d,{label:"Close",color:"primary",onClick:o=>e.closeAlertTimeDialog(t),flat:""},null,8,["onClick"])])]),_:2},1032,["modelValue","onUpdate:modelValue","onClose"])]),_:2},1032,["modelValue","onUpdate:modelValue"])])):h("",!0)])]),_:2},1024),l(A,{dark:""}),l(q,null,{default:n(()=>[this.habitsStore.habitNotCompleted(t)?(i(),r("div",fe,[t.ready?(i(),r("div",pe,[l(d,{class:u(e.buttonClass),flat:"",dense:"",icon:"done_all",color:"green",glossy:"",onClick:o=>e.completeHabit(t)},null,8,["class","onClick"])])):(i(),r("div",ge,[l(d,{class:u(e.buttonClass),flat:"",dense:"",icon:"check",color:"green",glossy:"",onClick:o=>e.completeHabit(t)},null,8,["class","onClick"])]))])):(i(),r("div",he,[l(d,{class:u(e.buttonClass),flat:"",dense:"",icon:"assignment_turned_in",color:"green",glossy:"",onClick:o=>e.completeHabit(t)},null,8,["class","onClick"])])),this.settingsStore.useNotificationBeta?(i(),r("div",ke,[l(d,{class:u(e.buttonClass),flat:"",dense:"",icon:"notifications",color:"red",glossy:"",onClick:o=>t.changeAlertTimeDialog=!0},null,8,["class","onClick"])])):h("",!0),l(d,{class:u(e.buttonClass),flat:"",dense:"",icon:"delete",color:"black",glossy:"",onClick:o=>e.removeHabit(t)},null,8,["class","onClick"])]),_:2},1024)]),_:2},1032,["class"])]),_:2},1024)),[[B]])),128))]),_:1})]),_:1})}var Ae=D(E,[["render",Se]]);export{Ae as default};
