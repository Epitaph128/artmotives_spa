import{_ as Q,F as A,o as M,ak as q,G as i,H as p,I as r,R as l,J as a,P as d,al as u,L as c,M as m,O as n,K as k,S as C,T as b,t as v,am as D,an as B,ao as y,ap as _,aq as U,ar as w,as as T}from"./index.d2b7b962.js";import{Q as N}from"./QBtnGroup.4b9cf58f.js";import{Q as H}from"./QTime.f3e61c36.js";import{Q as L}from"./QCircularProgress.d4f18dea.js";import{d as S,Q as $}from"./QItem.24bba064.js";import{Q as V}from"./QList.86d97a2c.js";import{Q as Y}from"./QPage.d0695579.js";import{u as P,Q as z}from"./QSpinnerFacebook.f8c24c2d.js";import{u as F}from"./store_habits.fb3abdfe.js";import{u as I}from"./store_successes.7211e793.js";import{u as R}from"./store_settings.92027855.js";import"./TouchPan.f72ff56c.js";import"./selection.d7f7c76d.js";const O=A({name:"HabitsPage",setup(){const e=P();let o;return M(()=>{o!==void 0&&(clearTimeout(o),e.loading.hide())}),{showLoading(){e.loading.show({spinner:z,spinnerColor:"white",spinnerSize:140,backgroundColor:"black",message:"Loading your habits... Please wait!",messageColor:"white"}),o=setTimeout(()=>{e.loading.hide(),o=void 0},500)}}},data(){return{changeDateDialog:!1,changeAlertTimeDialog:!1}},beforeMount(){this.habitsStore=F(),this.habitsStore.initialize(),this.successesStore=I(),this.successesStore.initialize(),this.settingsStore=R(),this.settingsStore.initialize(),this.$emit("refresh-header"),this.habitsStore.habits.forEach(e=>{e.startDate==null&&e.lastDate!=null&&(e.startDate=e.date)})},created(){this.showLoading()},computed:{...q(R,["useBigButtons"]),buttonClass(){return this.useBigButtons?"bigBtn":""},habitCardClass(e){return o=>this.habitsStore.habitNotCompleted(o)?"habit-card":"habit-card-complete"},formattedDate(){return function(e){const o=new Date(Date.parse(e));return S.formatDate(o,this.settingsStore.useDateFormat)}}},methods:{completeHabit(e){if(this.habitsStore.habitNotCompleted(e)&&!e.ready){e.ready=!0,this.$q.notify("Click again to mark complete!");return}var o=this.getDateWithTime();this.habitsStore.habitNotCompleted(e)?e.habit.length===0?this.$q.notify("Please enter a title for your new habit!"):this.$q.dialog({title:"Confirm",message:'Confirm completion of habit: "'+e.habit+'"',cancel:!0,persistent:!0}).onOk(()=>{e.lastDate==null&&(e.startDate=o),this.habitsStore.streakExpired(e)&&(e.streak=0),e.lastDate=o,e.dateTieBreaker=this.getTime(),e.streak=e.streak+1;var h=this.habitsStore.habitReward(e.streak);this.$q.notify("Rewarded "+h+" coins for completion!"),this.settingsStore.coins=this.settingsStore.coins+h,this.settingsStore.totalCoins=this.settingsStore.totalCoins+h,e.total=e.total+1,e.streak>e.longestStreak&&(e.longestStreak=e.streak),this.$q.notify(e.habit+" completed for "+this.getDate()+"!");var g=!1;if((e.streak==3||e.streak==5||e.streak==7||e.streak==14||e.streak==30||e.streak==60)&&(g=!0),g){var f=Object.assign({},e);f.date=this.getDateWithTime(),f.type="habit",this.successesStore.addEntry(f),this.$q.notify("Reached milestone of "+f.streak+" days!")}this.settingsStore.saveCoins(),this.$emit("refresh-header"),this.habitsStore.sortHabits()}):this.$q.notify("Habit already complete until "+e.resetTime+"!")},removeHabit(e){e.habit&&e.habit.length>0?this.$q.dialog({title:"Confirm",message:'Are you sure you want to delete the habit: "'+e.habit+'"?',cancel:!0,persistent:!0}).onOk(()=>{this.habitsStore.removeHabit(e.id),this.$q.notify('Habit deleted: "'+e.habit+'"')}):this.$q.dialog({title:"Confirm",message:"Are you sure you want to delete the unnamed habit?",cancel:!0,persistent:!0}).onOk(()=>{this.habitsStore.removeHabit(e.id),this.$q.notify("Habit deleted")})},hideTutorial(){this.$q.dialog({title:"Acknowledge",message:"Have you read and understood the instructions?",cancel:!0,persistent:!0}).onOk(()=>{this.settingsStore.tutorialSettings.habitsTutorialHidden=!0,this.settingsStore.saveTutorialSettings()})},getDenseDisplayButtonText(){return this.settingsStore.useDenseModeHabits?"Dense Mode Active":"Dense Mode Disabled"},toggleDenseDisplay(){this.settingsStore.useDenseModeHabits||(this.settingsStore.useDenseModeHabits=!1),this.settingsStore.useDenseModeHabits=!this.settingsStore.useDenseModeHabits,this.settingsStore.saveDenseModeHabitsSetting()},getDate(){const e=Date().toString();return S.formatDate(e,"MMM D, YYYY")},getDateWithTime(){const e=Date().toString();return S.formatDate(e,"MMM D, YYYY, hh:mm A")},getTime(){return new Date().getTime()},displayAlertTime(e){const o=new Date;return o.setHours(parseInt(e.split(":")[0],10)),o.setMinutes(parseInt(e.split(":")[1],10)),o.toLocaleTimeString([],{hour:"numeric",minute:"2-digit",hour12:!0})},closeAlertTimeDialog(e){e.changeAlertTimeDialog=!1,this.habitsStore.saveHabits()},showResetTime(e){return e.resetTime?e.resetTime:"12:00 AM"},closeResetTimeDialog(e){e.changeResetTimeDialog=!1,this.habitsStore.saveHabits()}}}),j={class:"flex justify-center q-mb-lg"},x={key:0,class:"tutorial"},E=l("p",null,' Click "New Habit" to create a new Habit. You can click the Habit Reset Time (which defaults to 12:00 AM) to adjust it. This is the time the habit resets and can be completed again. If an entire cycle goes without completion, then the habit will lose its streak and have to be restarted. Larger streaks grant higher coin rewards, so stay consistent for maximum benefits! ',-1),W={class:"habit-data"},G={class:"text-h6"},J={key:0},K={key:1},X={class:"reset-data"},Z=["onClick"],ee={class:"row items-center justify-center"},te=l("br",null,null,-1),se={key:0},oe=l("span",{class:"bold"},"Current Streak:",-1),ae=l("span",{class:"bold"},"Longest Streak:",-1),le=l("span",{class:"bold"},"Total completions:",-1),ie=l("br",null,null,-1),ne=l("span",{class:"bold"},"Started:",-1),re=l("span",{class:"bold"},"Last completed:",-1),de={class:"text-black"},ue=l("br",null,null,-1),ce={key:1,class:"alert-data"},me={key:0,"q-pa-lg":"",class:"text-black"},ge=l("br",null,null,-1),he={class:"row items-center justify-center"},fe={key:0},pe={key:0},ke={key:1},ye={key:1},Se={key:2,class:"alert-data"},Ce={class:"habit-data"},be={class:"text-h6"},ve={key:0},De={key:1},_e=["onClick"],we={key:0},Te={key:0},He={key:1},$e={key:1};function Ve(e,o,h,g,f,Re){return i(),p(Y,{"items-center":"",class:"habits-page"},{default:r(()=>[l("div",j,[a(N,null,{default:r(()=>[a(d,{class:u([e.buttonClass,"top-button"]),onClick:o[0]||(o[0]=t=>this.habitsStore.addHabit())},{default:r(()=>[c("New Habit")]),_:1},8,["class"]),a(d,{class:u([e.buttonClass,"top-button"]),style:{"margin-left":"1rem","margin-right":"0.5rem"},onClick:o[1]||(o[1]=t=>this.toggleDenseDisplay())},{default:r(()=>[c(m(this.getDenseDisplayButtonText()),1)]),_:1},8,["class"])]),_:1})]),this.settingsStore.tutorialSettings.habitsTutorialHidden?k("",!0):(i(),n("div",x,[E,a(d,{flat:"",dense:"",glossy:"",icon:"done",color:"check",onClick:o[2]||(o[2]=t=>this.hideTutorial())})])),this.settingsStore.useDenseModeHabits?(i(),p(V,{key:2},{default:r(()=>[(i(!0),n(b,null,C(this.habitsStore.habits,t=>v((i(),p($,{key:t},{default:r(()=>[a(D,{class:u([e.habitCardClass(t),"text-white full-width"])},{default:r(()=>[l("div",Ce,[l("div",be,[t.lastDate!=null?(i(),n("div",ve,[a(y,{multiline:"",autogrow:"",wrap:"on","min-rows":1,"max-rows":10,standout:"bg-primary text-black",class:"full-width text-h6","input-class":"text-left",label:"Habit Title",modelValue:t.habit,"onUpdate:modelValue":s=>t.habit=s,readonly:""},null,8,["modelValue","onUpdate:modelValue"])])):(i(),n("div",De,[a(y,{multiline:"",autogrow:"",wrap:"on","min-rows":1,"max-rows":10,standout:"bg-primary text-black",class:"full-width text-h6","input-class":"text-left",label:"Habit Title",modelValue:t.habit,"onUpdate:modelValue":[s=>t.habit=s,o[7]||(o[7]=s=>this.habitsStore.saveHabits())],onFocus:o[8]||(o[8]=s=>this.$q.notify("Habit will be saved once you enter a title"))},null,8,["modelValue","onUpdate:modelValue"])]))]),l("p",{class:u({dashed:!t.lastDate}),style:{padding:"1em 0.5em"},onClick:s=>{t.lastDate||(t.changeResetTimeDialog=!0)}}," Habit Resets at "+m(e.showResetTime(t)),11,_e)]),a(w,null,{default:r(()=>[this.habitsStore.habitNotCompleted(t)?(i(),n("div",we,[t.ready?(i(),n("div",Te,[a(d,{class:u(e.buttonClass),flat:"",dense:"",icon:"done_all",color:"green",glossy:"",onClick:s=>e.completeHabit(t)},null,8,["class","onClick"])])):(i(),n("div",He,[a(d,{class:u(e.buttonClass),flat:"",dense:"",icon:"check",color:"green",glossy:"",onClick:s=>e.completeHabit(t)},null,8,["class","onClick"])]))])):(i(),n("div",$e,[a(d,{class:u(e.buttonClass),flat:"",dense:"",icon:"assignment_turned_in",color:"green",glossy:"",onClick:s=>e.completeHabit(t)},null,8,["class","onClick"])])),a(d,{class:u(e.buttonClass),flat:"",dense:"",icon:"delete",color:"black",glossy:"",onClick:s=>e.removeHabit(t)},null,8,["class","onClick"])]),_:2},1024)]),_:2},1032,["class"])]),_:2},1024)),[[T]])),128))]),_:1})):(i(),p(V,{key:1},{default:r(()=>[(i(!0),n(b,null,C(this.habitsStore.habits,t=>v((i(),p($,{key:t},{default:r(()=>[a(D,{class:u([e.habitCardClass(t),"text-white full-width"])},{default:r(()=>[a(B,null,{default:r(()=>[l("div",W,[l("div",G,[t.lastDate!=null?(i(),n("div",J,[a(y,{multiline:"",autogrow:"",wrap:"on","min-rows":1,"max-rows":10,standout:"bg-primary text-black",class:"full-width text-h6","input-class":"text-left",label:"Habit Title",modelValue:t.habit,"onUpdate:modelValue":s=>t.habit=s,readonly:""},null,8,["modelValue","onUpdate:modelValue"])])):(i(),n("div",K,[a(y,{multiline:"",autogrow:"",wrap:"on","min-rows":1,"max-rows":10,standout:"bg-primary text-black",class:"full-width text-h6","input-class":"text-left",label:"Habit Title",modelValue:t.habit,"onUpdate:modelValue":[s=>t.habit=s,o[3]||(o[3]=s=>this.habitsStore.saveHabits())],onFocus:o[4]||(o[4]=s=>this.$q.notify("Habit will be saved once you enter a title"))},null,8,["modelValue","onUpdate:modelValue"])])),l("div",X,[l("p",{class:u({dashed:!t.lastDate}),onClick:s=>{t.lastDate||(t.changeResetTimeDialog=!0)}}," Habit Resets at "+m(e.showResetTime(t)),11,Z),a(_,{modelValue:t.changeResetTimeDialog,"onUpdate:modelValue":s=>t.changeResetTimeDialog=s},{default:r(()=>[a(H,{mask:"hh:mm A",modelValue:t.resetTime,"onUpdate:modelValue":[s=>t.resetTime=s,o[5]||(o[5]=s=>this.habitsStore.saveHabits())],onClose:s=>e.closeResetTimeDialog(t)},{default:r(()=>[l("div",ee,[a(d,{label:"Close",color:"primary",onClick:s=>e.closeResetTimeDialog(t),flat:""},null,8,["onClick"])])]),_:2},1032,["modelValue","onUpdate:modelValue","onClose"])]),_:2},1032,["modelValue","onUpdate:modelValue"])])]),te,t.startDate!=null?(i(),n("div",se,[l("p",null,[oe,c(" "+m(t.streak)+" days. ",1)]),l("p",null,[ae,c(" "+m(t.longestStreak)+" days. ",1)]),l("p",null,[le,c(" "+m(t.total)+" completions. ",1)]),ie,l("p",null,[ne,c(" "+m(e.formattedDate(t.startDate)),1)]),l("p",null,[re,c(" "+m(e.formattedDate(t.lastDate)),1)])])):k("",!0),l("p",de,[c(" Reward for completion: "),a(L,{"show-value":"",class:"text-light-blue q-ma-md",value:this.habitsStore.habitRewardPercent(t.streak+1),size:"64px",color:"light-blue"},{default:r(()=>[c(m(this.habitsStore.habitReward(t.streak+1)),1),ue,c(" coins ")]),_:2},1032,["value"])]),this.settingsStore.useNotificationBeta?(i(),n("div",ce,[t.alertTime?(i(),n("p",me,[ge,c("Alert Time: "+m(e.displayAlertTime(t.alertTime))+" Daily ",1)])):k("",!0),a(_,{modelValue:t.changeAlertTimeDialog,"onUpdate:modelValue":s=>t.changeAlertTimeDialog=s},{default:r(()=>[a(H,{modelValue:t.alertTime,"onUpdate:modelValue":[s=>t.alertTime=s,o[6]||(o[6]=s=>this.habitsStore.saveHabits())],onClose:s=>e.closeAlertTimeDialog(t)},{default:r(()=>[l("div",he,[a(d,{"float-left":"",label:"Disable",onClick:s=>this.habitsStore.disableNotification(t),color:"primary",flat:""},null,8,["onClick"]),a(d,{label:"Close",color:"primary",onClick:s=>e.closeAlertTimeDialog(t),flat:""},null,8,["onClick"])])]),_:2},1032,["modelValue","onUpdate:modelValue","onClose"])]),_:2},1032,["modelValue","onUpdate:modelValue"])])):k("",!0)])]),_:2},1024),a(U,{dark:""}),a(w,null,{default:r(()=>[this.habitsStore.habitNotCompleted(t)?(i(),n("div",fe,[t.ready?(i(),n("div",pe,[a(d,{class:u(e.buttonClass),flat:"",dense:"",icon:"done_all",color:"green",glossy:"",onClick:s=>e.completeHabit(t)},null,8,["class","onClick"])])):(i(),n("div",ke,[a(d,{class:u(e.buttonClass),flat:"",dense:"",icon:"check",color:"green",glossy:"",onClick:s=>e.completeHabit(t)},null,8,["class","onClick"])]))])):(i(),n("div",ye,[a(d,{class:u(e.buttonClass),flat:"",dense:"",icon:"assignment_turned_in",color:"green",glossy:"",onClick:s=>e.completeHabit(t)},null,8,["class","onClick"])])),this.settingsStore.useNotificationBeta?(i(),n("div",Se,[a(d,{class:u(e.buttonClass),flat:"",dense:"",icon:"notifications",color:"red",glossy:"",onClick:s=>t.changeAlertTimeDialog=!0},null,8,["class","onClick"])])):k("",!0),a(d,{class:u(e.buttonClass),flat:"",dense:"",icon:"delete",color:"black",glossy:"",onClick:s=>e.removeHabit(t)},null,8,["class","onClick"])]),_:2},1024)]),_:2},1032,["class"])]),_:2},1024)),[[T]])),128))]),_:1}))]),_:1})}var Oe=Q(O,[["render",Ve]]);export{Oe as default};
