import{a4 as o}from"./index.a276cf96.js";import{d as h}from"./QItem.ea6b81b4.js";const r="store_successes",c="store_successes_next_id",a="store_successes_archive",n="store_successes_first_date";function u(){const e=Date().toString();return h.formatDate(e,"MMM D, YYYY")}const S=o("successes",{state:()=>({successes:[],nextId:0,successesArchive:[],firstSuccessDate:null}),actions:{initialize(){const e=localStorage.getItem(c);this.nextId=e?JSON.parse(e):0;const s=localStorage.getItem(n);s&&(this.firstSuccessDate=s);const i=localStorage.getItem(r);i?(this.successes=JSON.parse(i),this.successes.forEach(t=>{t.id||(t.id=this.getNextId()),t.timeTieBreaker||(t.timeTieBreaker=t.dateTieBreaker)})):this.successes={},Array.isArray(this.successes)||(this.successes=[])},getNextId(){return this.nextId++,this.saveNextId(),this.nextId-1},saveNextId(){localStorage.setItem(c,JSON.stringify(this.nextId))},initializeArchive(){const e=localStorage.getItem(a);e?(this.successesArchive=JSON.parse(e),this.successesArchive.forEach(s=>{s.id||(s.id=this.getNextId()),s.timeTieBreaker||(s.timeTieBreaker=s.dateTieBreaker)})):this.successesArchive={},Array.isArray(this.successesArchive)||(this.successesArchive=[])},addEntry(e){e.id=this.getNextId(),this.successes.push(e),this.firstSuccessDate||(this.firstSuccessDate=u(),this.saveFirstSuccessDate()),this.sortEntries()},removeEntry(e){const s=this.successes.findIndex(i=>i.id===e);this.successes.splice(s,1),this.saveEntries()},removeArchivedEntry(e){const s=this.successesArchive.findIndex(i=>i.id===e);this.successesArchive.splice(s,1),this.saveArchivedEntries()},saveEntries(){localStorage.setItem(r,JSON.stringify(this.successes))},saveArchivedEntries(){localStorage.setItem(a,JSON.stringify(this.successesArchive))},saveFirstSuccessDate(){localStorage.setItem(n,this.firstSuccessDate)},eraseSettings(){localStorage.setItem(n,"")},eraseEntries(){localStorage.setItem(r,JSON.stringify([])),localStorage.setItem(c,JSON.stringify(0))},eraseArchivedEntries(){localStorage.setItem(a,JSON.stringify([]))},sortEntries(){this.successes.sort((e,s)=>{const i=new Date(e.date),t=new Date(s.date);return i<t?1:i>t?-1:s.timeTieBreaker-e.timeTieBreaker}),this.saveEntries()},sortArchivedEntries(){this.successesArchive.sort((e,s)=>{const i=new Date(e.date),t=new Date(s.date);return i<t?1:i>t?-1:s.timeTieBreaker-e.timeTieBreaker}),this.saveArchivedEntries()},daysSinceFirstSuccess(){const e=this.firstSuccessDate?new Date(this.firstSuccessDate):new Date,s=new Date,i=Math.abs(s-e);let t=Math.round(i/(1e3*60*60*24));return t<1&&(t=1),t},archiveOldEntries(){if(this.successes.length<=30)return!0;for(;this.successes.length>30;)this.successesArchive.unshift(this.successes.pop());return this.saveEntries(),this.saveArchivedEntries(),!1}}});export{S as u};
